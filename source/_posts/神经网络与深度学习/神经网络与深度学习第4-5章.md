---
title: ã€Šç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ã€‹ç¬¬4-5ç« 
date: 2021-08-10
categories:
- ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ 
tags:
- ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ 
language: zh-CN
toc: true
---

##### å¦‚ä½•ç†è§£åå‘ä¼ æ’­ï¼Ÿ

â€‹	é¦–å…ˆä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ¢¯åº¦ä¸‹é™æ³•ã€‚ä»¥ç¥ç»ç½‘ç»œä¸ºä¾‹ï¼Œç»™å®šä¸€ç»„ç¥ç»ç½‘ç»œå‚æ•°ï¼Œå³
$$
\theta=\{w_1,w_2,...,b_1,b_2,...\}
$$
è®°
$$
\nabla L(\theta)=\left[\begin{matrix}
\frac{\partial L(\theta)}{\partial w_1} \\
\frac{\partial L(\theta)}{\partial w_2} \\
\vdots \\
\frac{\partial L(\theta)}{\partial b_1} \\
\frac{\partial L(\theta)}{\partial b_2} \\
\vdots
\end{matrix}\right]
$$
é€šè¿‡è®¡ç®—$\nabla L(\theta^0)$ï¼Œå¾—åˆ°$\theta^1=\theta^0-\eta\nabla L(\theta^0)$ï¼Œé€šè¿‡è®¡ç®—$\nabla L(\theta^1)$ï¼Œå¾—åˆ°$\theta^2=\theta^1-\eta\nabla L(\theta^1)$ï¼Œä¸æ–­åå¤ï¼Œæœ€åæ‰¾åˆ°æœ€ä½³å‚æ•°ã€‚ä¸çº¿æ€§å›å½’ï¼Œé€»è¾‘å›å½’ä¸åŒçš„æ˜¯ï¼Œç¥ç»ç½‘ç»œä¸­å¾€å¾€å‚æ•°é‡æ˜¯ç™¾ä¸‡çº§åˆ«çš„ï¼Œå¦‚ä½•æœ‰æ•ˆç‡åœ°è®¡ç®—æ¢¯åº¦ï¼Œè¿™ä¾¿æ˜¯åå‘ä¼ æ’­çš„ä½œç”¨ã€‚

<!--more-->

â€‹	è¿™é‡Œå…ˆä»‹ç»ä¸€ä¸‹é“¾å¼æ³•åˆ™ï¼Œå¦‚ä¹¦ä¸­é™„å½•éƒ¨åˆ†ï¼š

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%93%BE%E5%BC%8F%E6%B3%95%E5%88%99.png)

ä»¥B.16ä¸ºä¾‹ï¼Œ$\Delta x\rightarrow\Delta y\rightarrow\Delta z$ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰$\frac{\partial z}{\partial x}=\frac{\partial z}{\partial y}\frac{\partial y}{\partial x}$ã€‚

è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯$x=g(t),y=h(t),z=k(x,y)$ï¼Œæ­¤æ—¶$$\frac{\partial z}{\partial t}=\frac{\partial z}{\partial x}\frac{\partial x}{\partial t}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial t}$$

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%93%BE%E5%BC%8F%E6%B3%95%E5%88%991.png)

è¿™é‡Œä¸ºäº†è¯´æ˜æ–¹ä¾¿ï¼Œæˆ‘ä»¬æˆªå–ç‰¹å®šè¾“å…¥æ ·æœ¬çš„æŸä¸€å±‚çš„æŸä¸ªç¥ç»å…ƒè¿›è¡Œè¯´æ˜ã€‚è¿™é‡Œåªä»‹ç»$\frac{\partial C}{\partial w}$ï¼Œå› ä¸ºè®¡ç®—$\frac{\partial C}{\partial b}$çš„åŸç†æ˜¯ä¸€æ ·çš„ã€‚
$$
L(\theta)=\sum_{n=1}^NC^n(\theta)\rightarrow \frac{\partial L(\theta)}{\partial w}=\sum_{n=1}^{N}\frac{\partial C(\theta)}{\partial w}
$$
<img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%AF%B4%E6%98%8E1.png" style="zoom:50%;" />

æ˜¾ç„¶å‰é¢çš„è¿™ä¸€é¡¹$\frac{\partial z}{\partial w}$éå¸¸å®¹æ˜“è®¡ç®—ï¼Œå¦‚å›¾ä¸­æ‰€ç¤ºï¼Œ$$\frac{\partial z}{\partial w_1}=x_1 , \frac{\partial z}{\partial w_2}=x_2$$ï¼Œ**å…¶ç»“æœå°±æ˜¯è¿æ¥è¿™ä¸ªæƒé‡çš„è¾“å…¥**ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªè¿‡ç¨‹ä¸ºé¡ºæ¨æ³•ã€‚è€Œè®¡ç®—$\frac{\partial C}{\partial z}$å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%AF%B4%E6%98%8E2.png" style="zoom:50%;" />

æˆ‘ä»¬çŸ¥é“$\frac{\partial a}{\partial z}=\sigma'(z)$ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è®¡ç®—$\frac{\partial C}{\partial a}$ï¼Œå›¾ä¸­é€šè¿‡é“¾å¼æ³•åˆ™æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼Œå¤æ‚çš„æƒ…å†µä¸‹ï¼Œä¸‹é¢å¯èƒ½ä¼šäº§ç”Ÿå¾ˆå¤šé¡¹ï¼š
$$
\frac{\partial C}{\partial a}=\frac{\partial z'}{\partial a}\frac{\partial C}{\partial z'}+\frac{\partial z''}{\partial a}\frac{\partial C}{\partial z''}
$$
å…¶ä¸­çš„$\frac{\partial z'}{\partial a}$å’Œ$\frac{\partial z''}{\partial a}$å¾ˆå®¹æ˜“è®¡ç®—ï¼Œå°±æ˜¯$w_3$å’Œ$w_4$ï¼Œæ­¤æ—¶æˆ‘ä»¬å¾—åˆ°ï¼š
$$
\frac{\partial C}{\partial z}=\sigma'(z)[w_3 \frac{\partial C}{\partial z'}+w_4\frac{\partial C}{\partial z''}]
$$
ä¸Šè¿°å…¬å¼å¯ä»¥çœ‹å‡ºå¦‚ä¸‹çš„ç±»ä¼¼çš„åå‘ç¥ç»ç½‘ç»œï¼Œå…¶ä¸­$\sigma'(z)$æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå› ä¸ºåœ¨å‰å‘ä¼ æ’­ä¸­ï¼Œzçš„å€¼å·²ç»è¢«è®¡ç®—å‡ºæ¥ï¼Œå¸¦å…¥å³å¯å¾—åˆ°å…¶å€¼ã€‚

<img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%AF%B4%E6%98%8E3.png" style="zoom:50%;" />

ç°åœ¨æ‰€æœ‰çš„é—®é¢˜éƒ½é›†ä¸­åœ¨å¦‚ä½•è®¡ç®—$\frac{\partial C}{\partial z'}$å’Œ$\frac{\partial C}{\partial z''}$ï¼Œä¼šé‡åˆ°ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§å°±æ˜¯$z',z''$å·²ç»åˆ°è¾¾è¾“å‡ºå±‚ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

<img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%AF%B4%E6%98%8E4.png" style="zoom:50%;" />

è¿™ä¸¤é¡¹éƒ½å¯ä»¥ç›´æ¥è®¡ç®—å¾—å‡ºï¼Œå› ä¸ºä½ çŸ¥é“æœ€åçš„æ¿€æ´»å‡½æ•°ï¼Œä½ ä¹ŸçŸ¥é“ä½ çš„æŸå¤±å‡½æ•°æ˜¯æ€ä¹ˆå®šä¹‰çš„ã€‚

è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯$z',z''$åªæ˜¯åœ¨ä¸­é—´çš„éšè—å±‚ï¼Œåé¢è¿˜æœ‰è®¸å¤šå±‚ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

<img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%AF%B4%E6%98%8E5.png" style="zoom:50%;" />

æˆ‘ä»¬å‘ç°è®¡ç®—$\frac{\partial C}{\partial z'}$å’Œ$\frac{\partial C}{\partial z''}$ä¸ä¹‹å‰è®¡ç®—$\frac{\partial C}{\partial z}$ä¸€æ ·ï¼Œä¾‹å¦‚:
$$
\frac{\partial C}{\partial z'}=\frac{\partial a'}{\partial z'}\frac{\partial C}{\partial a'}=\sigma'(z')[\frac{\partial z_a}{\partial a'}\frac{\partial C}{\partial z_a}+\frac{\partial z_b}{\partial a'}\frac{\partial C}{\partial z_b}]=\sigma'(z')[w_5 \frac{\partial C}{\partial z_a}+w_6\frac{\partial C}{\partial z_b}]
$$
æ¥ä¸‹æ¥å°±æ˜¯æ— çº¿å¥—å¨ƒçš„è¿‡ç¨‹ï¼Œè¿™é‡Œæˆ‘ä»¬å¦‚æœä¸€ç›´ä»å‰å¾€åæ¨è¿™æ˜¯éå¸¸å¤æ‚çš„è¿‡ç¨‹ï¼Œä½†å¦‚æœæˆ‘ä»¬ä¸€å¼€å§‹å°±ä»åå¾€å‰è®¡ç®—ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±å˜å¾—å¾ˆç®€å•ï¼Œè¿™ä¾¿æ˜¯åå‘ä¼ æ’­ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå¦‚æœæˆ‘ä»¬è¦è®¡ç®—$\frac{\partial C}{\partial z_1}$ï¼Œæ­£å‘è®¡ç®—æˆ‘ä»¬éœ€è¦ç®—$\frac{\partial C}{\partial z_3},\frac{\partial C}{\partial z_4},\frac{\partial C}{\partial z_5},\frac{\partial C}{\partial z_6}$ï¼Œè€Œæƒ³è¦å¾—åˆ°$\frac{\partial C}{\partial z_3}$ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—$\frac{\partial C}{\partial z_5},\frac{\partial C}{\partial z_6}$ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå›¾ä¸­æ‰€ç»™ç¤ºä¾‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ç»“æ„ï¼Œå¦‚æœå¤æ‚ä¸€ç‚¹ï¼Œè®¡ç®—é‡å¯æƒ³è€ŒçŸ¥ã€‚

<img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%AF%B4%E6%98%8E6.png" style="zoom:50%;" />

è€Œç°åœ¨ï¼Œæˆ‘ä»¬ä»åé¢å¾€å‰ç®—ï¼Œå…ˆè®¡ç®—$\frac{\partial C}{\partial z_5},\frac{\partial C}{\partial z_6}$ï¼Œå†æ ¹æ®$\frac{\partial C}{\partial z_5},\frac{\partial C}{\partial z_6}$è®¡ç®—$\frac{\partial C}{\partial z_3},\frac{\partial C}{\partial z_4}$ï¼Œå†æ ¹æ®$\frac{\partial C}{\partial z_3},\frac{\partial C}{\partial z_4}$ï¼Œè®¡ç®—$\frac{\partial C}{\partial z_1},\frac{\partial C}{\partial z_2}$.

æ€»ç»“ä¸€ä¸‹åå‘ä¼ æ’­çš„è¿‡ç¨‹å°±æ˜¯å…ˆé¡ºæ¨å‡ºä¾‹å¦‚$\frac{\partial z}{\partial w}$çš„å€¼ï¼Œç„¶åé€†æ¨å‡º$\frac{\partial C}{\partial z}$,æœ€ç»ˆä¾¿å¯ä»¥å¾—åˆ°$\frac{\partial C}{\partial w}=\frac{\partial z}{\partial w}\frac{\partial C}{\partial z}$.

##### è‡ªåŠ¨æ¢¯åº¦è®¡ç®—

è¿™ä¸ªéƒ¨åˆ†å¯ä»¥å‚è€ƒè®ºæ–‡[ã€ŠAutomatic Differentiation in Machine Learning: a Surveyã€‹](https://arxiv.org/pdf/1502.05767.pdf)

- æ•°å€¼å¾®åˆ†

  æ•°å€¼å¾®åˆ†ï¼ˆNumerical Differentiationï¼‰æ˜¯ç”¨æ•°å€¼æ–¹æ³•æ¥è®¡ç®—å‡½æ•°ğ‘“(ğ‘¥)çš„å¯¼æ•°ã€‚å‡½æ•°ğ‘“(ğ‘¥)çš„ç‚¹ğ‘¥çš„å¯¼æ•°å®šä¹‰ä¸º
  $$
  f'(x)=\lim_{\Delta x\rightarrow0}\frac{f(x+\Delta x)-f(x)}{\Delta x}
  $$
  æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ‰°åŠ¨ Î”ğ‘¥ååˆ†å›°éš¾ã€‚å¦‚æœ Î”ğ‘¥ è¿‡å°ï¼Œä¼šå¼•èµ·æ•°å€¼è®¡ç®—é—®é¢˜ï¼Œæ¯”å¦‚èˆå…¥è¯¯å·®ï¼›å¦‚æœÎ”ğ‘¥ è¿‡å¤§ï¼Œä¼šå¢åŠ æˆªæ–­è¯¯å·®ï¼Œä½¿å¾—å¯¼æ•°è®¡ç®—ä¸å‡†ç¡®ã€‚å› æ­¤ï¼Œæ•°å€¼å¾®åˆ†çš„å®ç”¨æ€§æ¯”è¾ƒå·®ã€‚

  ä½•ä¸ºæˆªæ–­è¯¯å·®ï¼Ÿä¾‹å¦‚å‡½æ•°$e^x$å¯ä»¥å±•å¼€ä¸ºæ— ç©·å¹‚çº§æ•°ï¼š
  $$
  e^x=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+\frac{x^4}{4!}+\dots
  $$
  è‹¥å–å…¶ä¸­çš„éƒ¨åˆ†é¡¹æ¯”å¦‚:
  $$
  e^x\approx 1+x+\frac{x^2}{2!}
  $$
  ä½œä¸ºå…¶è¿‘ä¼¼è®¡ç®—å…¬å¼ï¼Œäºæ˜¯åé¢çš„é¡¹ä¾¿èˆå¼ƒäº†ï¼Œä¾¿äº§ç”Ÿäº†è¯¯å·®ï¼Œè¿™å°±æ˜¯**æˆªæ–­è¯¯å·®**ã€‚

  ä¹¦ä¸­è¯´ä½¿ç”¨ä¸‹é¢å…¬å¼æ¥è®¡ç®—æ¢¯åº¦ï¼Œå¯ä»¥å‡å°‘æˆªæ–­è¯¯å·®ï¼Œä¹Ÿç§°ä¸­å¿ƒå·®åˆ†ï¼š
  $$
  f'(x)=\lim_{\Delta x\rightarrow0}\frac{f(x+\Delta x)-f(x-\Delta x)}{2\Delta x}
  $$
  åˆ©ç”¨pythonç¨‹åºè¿›è¡ŒéªŒè¯ï¼š

  <img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E6%95%B0%E5%80%BC%E5%BE%AE%E5%88%86%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90.png" style="zoom:50%;" />

  | $f(x)=e^ x$ | h=0.1              | h=0.01             | h=0.001            |
  | ----------- | ------------------ | ------------------ | ------------------ |
  | å‰å‘å·®åˆ†    | 1.0517091807564771 | 1.005016708416795  | 1.0005001667083846 |
  | åå‘å·®åˆ†    | 0.9516258196404048 | 0.9950166250831893 | 0.9995001666249781 |
  | ä¸­å¿ƒå·®åˆ†    | 1.001667500198441  | 1.0000166667499921 | 1.0000001666666813 |

- ç¬¦å·å¾®åˆ†

  ç¬¦å·å¾®åˆ†å¯ä»¥åˆ©ç”¨ä»£æ•°è½¯ä»¶è‡ªåŠ¨å®ç°ä¸€äº›å¾®åˆ†çš„å…¬å¼ï¼Œæ¯”å¦‚ï¼š
  $$
  \frac{d}{dx}(f(x)+g(x)) \leadsto \frac{d}{dx}f(x)+\frac{d}{dx}g(x)
  $$
  
  $$
  \frac{d}{dx}(f(x)g(x))\leadsto(\frac{d}{dx}f(x))g(x)+f(x)(\frac{d}{dx}g(x))
  $$
  
  ç¬¦å·å¾®åˆ†æœ‰ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼š1ï¼‰ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¾ªç¯ï¼Œéœ€è¦å¾ˆé•¿æ—¶é—´è¿›è¡Œç¼–è¯‘ï¼›2ï¼‰ä¸ºäº†è¿›è¡Œç¬¦å·å¾®åˆ†ï¼Œä¸€èˆ¬éœ€è¦è®¾è®¡ä¸€ç§ä¸“é—¨çš„è¯­è¨€æ¥è¡¨ç¤ºæ•°å­¦è¡¨è¾¾å¼ï¼Œå¹¶ä¸”è¦å¯¹å˜é‡ï¼ˆç¬¦å·ï¼‰è¿›è¡Œé¢„å…ˆå£°æ˜ï¼›3ï¼‰å¾ˆéš¾å¯¹ç¨‹åºè¿›è¡Œè°ƒè¯•ã€‚
  
  åŒæ—¶ï¼Œç¬¦å·å¾®åˆ†è¿˜å­˜åœ¨è¡¨è¾¾å¼è†¨èƒ€ï¼ˆ expression swellï¼‰çš„é—®é¢˜ï¼Œå¦‚è¡¨æ‰€ç¤ºï¼š
  
  <img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/expression%20swell.png" style="zoom:50%;" />

- è‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic Differentiationï¼ŒADï¼‰

  ä»¥å¤åˆå‡½æ•°$f(x;w,b)$ä¸ºä¾‹ï¼š
  $$
  f(x;w,b)=\frac{1}{\exp(-(wx+b))+1}
  $$
  å°†å…¶åˆ†è§£ä¸ºä¸€ç³»åˆ—åŸºæœ¬æ“ä½œï¼Œå¹¶ä¸”æ„æˆä¸€ä¸ªè®¡ç®—å›¾ï¼Œè®¡ç®—å›¾ä¸­çš„æ¯ä¸ªéå¶å­èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªåŸºæœ¬æ“ä½œï¼Œæ¯ä¸ªå¶å­èŠ‚ç‚¹ä¸ºä¸€ä¸ªè¾“å…¥å˜é‡æˆ–å¸¸é‡ã€‚ä¸‹å›¾ç»™å‡ºäº†å½“ ğ‘¥ = 1, ğ‘¤ = 0, ğ‘ = 0 æ—¶å¤åˆå‡½æ•°$f(x;w,b)$çš„è®¡ç®—å›¾ï¼š

  <img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%A4%8D%E5%90%88%E5%87%BD%E6%95%B0f%E7%9A%84%E8%AE%A1%E7%AE%97%E5%9B%BE.png" style="zoom:50%;" />

  å¯ä»¥çœ‹å‡ºè¯¥å‡½æ•°ç”±6ä¸ªåŸºæœ¬å‡½æ•°ç»„æˆï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

  <img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E7%BB%84%E6%88%90f%E7%9A%84%E5%85%AD%E4%B8%AA%E5%9F%BA%E6%9C%AC%E5%87%BD%E6%95%B0.png" style="zoom:50%;" />

  é€šè¿‡è®¡ç®—å›¾ä¸Šä¸å‚æ•°$w$å’Œ$b$æœ‰å…³çš„è·¯å¾„å¯ä»¥å¾—åˆ°å‡½æ•°$f(x;w,b)$å…³äºå‚æ•°$w$å’Œ$b$çš„å¯¼æ•°ï¼š

  <img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/f%E5%85%B3%E4%BA%8Ew%E5%92%8Cb%E7%9A%84%E5%AF%BC%E6%95%B0.png" style="zoom:50%;" />

  <img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%AF%BC%E6%95%B0f%E4%BB%A3%E5%85%A5%E5%80%BC.png" style="zoom:50%;" />

  å‰å‘æ¨¡å¼ï¼šä¸è®¡ç®—å›¾è®¡ç®—æ–¹å‘ç›¸åŒé€’å½’åœ°è®¡ç®—æ¢¯åº¦ï¼Œå…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š
  $$
  \begin{align*}
  &\frac{\partial h_1}{\partial w}=x=1	\\
  &\frac{\partial h_2}{\partial w}=\frac{\partial h_2}{\partial h_1}\frac{\partial h_1}{\partial w}=1 \times 1=1 \\
  &\frac{\partial h_3}{\partial w}=\frac{\partial h_3}{\partial h_2}\frac{\partial h_2}{\partial w}=-1\times 1=-1 \\
  &\frac{\partial h_4}{\partial w}=\frac{\partial h_4}{\partial h_3}\frac{\partial h_3}{\partial w}=\exp(h3)\times -1=1\times -1=-1 \\
  &\frac{\partial h_5}{\partial w}=\frac{\partial h_5}{\partial h_4}\frac{\partial h_4}{\partial w}=1\times-1=-1\\
  &\frac{\partial h_6}{\partial w}=\frac{\partial h_6}{\partial h_5}\frac{\partial h_5}{\partial w}=-0.25\times-1=0.25\\
  &\frac{\partial f(x;w,b)}{\partial w}=\frac{\partial f(x;w,b)}{\partial h_6}\frac{\partial h_6}{\partial w}=1\times0.25=0.25
  \end{align*}
  $$
  åå‘æ¨¡å¼ï¼šä¸åå‘ä¼ æ’­çš„è®¡ç®—æ–¹å¼ç›¸åŒï¼Œå¯ä»¥è¯´åå‘ä¼ æ’­æ˜¯åå‘æ¨¡å¼çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚

  <img src="https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E5%89%8D%E5%90%91%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%8F%8D%E5%90%91%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AF%B9%E6%AF%94.png"/>

  å¦‚ä½•ç†è§£ï¼Ÿå¯¹äºåƒç¥ç»ç½‘ç»œè¿™ç§æ¨¡å‹ï¼Œé€šå¸¸è¾“å…¥æ˜¯ä¸Šä¸‡åˆ°ä¸Šç™¾ä¸‡ç»´ï¼Œè€Œè¾“å‡ºæŸå¤±å‡½æ•°æ˜¯ä¸€ç»´çš„æ¨¡å‹ï¼Œåªéœ€è¦ä¸€éåå‘æ¨¡å¼çš„è®¡ç®—è¿‡ç¨‹ï¼Œä¾¿å¯ä»¥æ±‚å‡ºè¾“å‡ºå¯¹äºå„ä¸ªè¾“å…¥çš„å¯¼æ•°ï¼Œä»è€Œè½»æ¾æ±‚å–æ¢¯åº¦ç”¨äºåç»­ä¼˜åŒ–æ›´æ–°ã€‚

##### å¦‚ä½•ç†è§£é€šç”¨è¿‘ä¼¼å®šç†(å¦‚ä½•ç†è§£ç¥ç»ç½‘ç»œ)ï¼Ÿ

â€‹	å¦‚å›¾æ‰€ç¤ºï¼Œç°åœ¨æœ‰å¦‚ä¸‹å‡½æ•°éœ€è¦æˆ‘ä»¬å»æ‹Ÿåˆï¼Œæ˜¾ç„¶è¿™æ¡çº¢è‰²çš„æŠ˜çº¿æ®µå¯ä»¥è¡¨ç¤ºä¸ºï¼šçº¢è‰²çº¿=å¤šä¸ªåˆ†æ®µå‡½æ•°ç´¯åŠ +å¸¸é‡ï¼ˆåç½®ï¼‰

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%86.png)

â€‹	å¦‚å›¾æ‰€ç¤ºï¼Œçº¢è‰²æŠ˜çº¿æ®µå¯ä»¥ç”±**è“è‰²çº¿æ®µ0ï¼ˆå¸¸é‡åç½®ï¼‰+è“è‰²çº¿æ®µ1+è“è‰²çº¿æ®µ2+è“è‰²çº¿æ®µ3**åˆæˆã€‚

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%861.png)

â€‹	é€šè¿‡è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥çŸ¥é“ä»»æ„çš„åˆ†æ®µçº¿æ€§å‡½æ•°å¯ä»¥ç”±ä¸€ä¸ªå¸¸é‡+å¤šä¸ªå¦‚å›¾æ‰€ç¤ºçš„è“è‰²å‡½æ•°ç»„æˆï¼Œåªæ˜¯ä¸åŒçš„åˆ†æ®µçº¿æ€§å‡½æ•°æ‰€ç”¨çš„è“è‰²å‡½æ•°ä¸ä¸€å®šç›¸åŒã€‚

â€‹	å½“ç„¶å®é™…æˆ‘ä»¬é‡åˆ°çš„å‡½æ•°å›°éš¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¯ä¸€æ¡è¿ç»­çš„æ›²çº¿ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥ç”¨å¤šæ¡ç›´çº¿æ®µåˆæˆå»é€¼è¿‘è¿™æ¡æ›²çº¿ï¼ˆåªè¦æˆ‘ä»¬ç»¿è‰²çš„ç‚¹å–çš„è¶³å¤Ÿçš„å¤šï¼‰ï¼Œè¿™é‡Œä¹Ÿå°±å‘Šè¯‰æˆ‘ä»¬åªè¦è“è‰²çš„å‡½æ•°è¶³å¤Ÿåœ°å¤šï¼Œé‚£ä¹ˆä»»æ„ä¸€æ¡æ›²çº¿æˆ‘ä»¬éƒ½å¯ä»¥å»é€¼è¿‘ã€‚

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%862.png)

â€‹	é‚£ä¹ˆç°åœ¨çš„é—®é¢˜å°±æ˜¯æˆ‘ä»¬æ€ä¹ˆå»è¡¨ç¤ºè¿™äº›è“è‰²çš„å‡½æ•°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœç”¨åˆ†æ®µå‡½æ•°çš„å½¢å¼å»è¡¨ç¤ºï¼Œç»“æ„æœ‰ä¸€äº›å¤æ‚ï¼Œä»”ç»†è§‚å¯Ÿï¼Œè¿™æ ·çš„å‡½æ•°éå¸¸åƒsigmoidå‡½æ•°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%863.png)

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%864.png)

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å½¢å¦‚ï¼š$y=c\frac{1}{1+e^{-(b+wx_1)}}$çš„æ›²çº¿ï¼ˆå¹³æ»‘ï¼Œæ˜“äºæ±‚å¯¼ï¼‰å»é€¼è¿‘ä¸Šè¿°è“è‰²çš„åˆ†æ®µå‡½æ•°ï¼ˆè¿™é‡Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œHard Sigmoidâ€ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ç”¨sigmoidå‡½æ•°å»é€¼è¿‘å„ç§å„æ ·çš„è“è‰²åˆ†æ®µå‡½æ•°ã€‚

â€‹	æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦è°ƒæ•´å‚æ•°å€¼ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸åŒçš„sigmoidå‡½æ•°ï¼Œæ€»ç»“ä¸€ä¸‹ï¼Œæ•´ä½“çš„æµç¨‹å°±æ˜¯ï¼šé€šè¿‡å„ç§çš„sigmoidå‡½æ•°å»é€¼è¿‘å„ç§å„æ ·çš„hard sigmoid(è“è‰²å‡½æ•°)ï¼Œé€šè¿‡å¤šä¸ªhard sigmoidåˆæˆå¾—åˆ°çº¿æ€§åˆ†æ®µå‡½æ•°ï¼Œç”¨çº¿æ€§åˆ†æ®µå‡½æ•°å»è¿‘ä¼¼å„ç§çš„è¿ç»­å‡½æ•°ã€‚

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%865.png)

â€‹	æ¥çœ‹åˆšåˆšçš„ä¾‹å­ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œè¿™æ¡çº¢è‰²çš„çº¿æ€§åˆ†æ®µå‡½æ•°ä¾¿å¯ä»¥ç”¨å¦‚ä¸‹çš„å½¢å¼å»æ‹Ÿåˆï¼š
$$
y=b+\sum_ic_isigmoid(b_i+wix_1)
$$
![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%866.png)

è¿™é‡Œå‡ºç°äº†**é€šç”¨è¿‘ä¼¼å®šç†**çš„é›å½¢ï¼Œæƒ³å¯¹äºä¹‹å‰çš„åªæœ‰ä¸€ä¸ªç‰¹å¾çš„çº¿æ€§å›å½’æ¨¡å‹$y=b+wx_1$ï¼Œæ­¤å¤„çš„æ¨¡å‹å˜å¾—æ›´æœ‰å¼¹æ€§ã€‚å¦‚æœçº¿æ€§æ¨¡å‹å˜ä¸ºå¤šç»´ç‰¹å¾è¾“å…¥ï¼Œå½¢å¦‚ï¼š
$$
y=b+\sum_jw_jx_j
$$
æˆ‘ä»¬åŒæ ·å¯ä»¥ç”¨å¦‚ä¸‹çš„æ¨¡å‹å»æ‹Ÿåˆï¼š
$$
y=b+\sum_ic_isigmoid(bi+\sum_jw_{ij}x_j)
$$
è¿™ä¸ªå°±æ˜¯é€šç”¨è¿‘ä¼¼å®šç†ç»™å‡ºçš„å½¢å¼ã€‚ä¸Šé¢çš„å…¬å¼æ‹†è§£ä¸€ä¸‹ï¼Œå°±å˜æˆäº†ç¥ç»ç½‘ç»œçš„å½¢å¼ã€‚ç°åœ¨æˆ‘ä»¬åªå…³æ³¨$sigmoid(bi+\sum_jw_{ij}x_j)$ï¼Œæˆ‘ä»¬å‡å®ši=1ï¼Œ2ï¼Œ3ï¼›j=1,2,3ï¼Œå¯ä»¥æœ‰
$$
\begin{align*}
&r_1=b_1+w_{11}x_1+w_{12}x_2+w_{13}x_3\\
&r_2=b_2+w_{21}x_1+w_{22}x_2+w_{23}x_3\\
&r_3=b_3+w_{31}x_1+w_{32}x_2+w_{33}x_3\\
\end{align*}
$$
ä¹Ÿå°±æ˜¯ï¼š
$$
\left[\begin{matrix}
r_1\\
r_2\\
r_3
\end{matrix}\right]=
\left[\begin{matrix}
b_1\\
b_2\\
b_3
\end{matrix}\right]+
\left[\begin{matrix}
w_{11}&w_{12}&w_{13}\\
w_{21}&w_{22}&w_{23}\\
w_{31}&w_{32}&w_{33}\\
\end{matrix}\right]
\left[\begin{matrix}
x_1\\
x_2\\
x_3
\end{matrix}\right]
$$
è®°ä½œï¼š
$$
\mathbf{r=b+wx}
$$
æœ€ç»ˆå‡½æ•°çš„å½¢å¼ä¹Ÿå°±å¯ä»¥è¡¨ç¤ºä¸º:
$$
y=b+\mathbf{c^T}\sigma(\mathbf{b+wx})
$$
è¿™ä¾¿æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œçš„ç»“æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™é‡Œä¹Ÿè§£é‡Šäº†ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•æ‹Ÿåˆä»»æ„å‡½æ•°çš„ã€‚

![](https://cxd-note-img.oss-cn-hangzhou.aliyuncs.com/typora-note-img/%E9%80%9A%E7%94%A8%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%867.png)

â€‹	ç®€å•åœ°è¯´ï¼Œé€šç”¨è¿‘ä¼¼å®šç†å®šä¹‰äº†ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œåªéœ€è¦å…¶ä¸­æœ‰ä¸€ä¸ªåŒ…å«è¶³å¤Ÿå¤šä½†æœ‰é™æ•°é‡ç¥ç»å…ƒçš„éšè—å±‚ï¼Œåœ¨æ¿€æ´»å‡½æ•°çš„ä½œç”¨ä¸‹ï¼ˆä¹¦ä¸­è¯´ğœ™(â‹…)æ˜¯ä¸€ä¸ªéå¸¸æ•°ã€æœ‰ç•Œã€å•è°ƒé€’å¢çš„è¿ç»­å‡½æ•°ï¼‰ï¼Œæˆ‘çš„ç†è§£æ˜¯å°±æ˜¯ä¸€ä¸ªSå‹çš„å‡½æ•°ï¼Œåé¢ç”±*Kurt* *Hornik*è¯æ˜é€šç”¨è¿‘ä¼¼å®šç†å¹¶ä¸ä¾èµ–äºç‰¹å®šçš„æ¿€æ´»å‡½æ•°ï¼Œè€Œæ˜¯ç”±å¤šå±‚å‰é¦ˆç½‘ç»œç»“æ„æ‰€å†³å®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥å®šç†é€‚åˆæ‰€æœ‰æ¿€æ´»å‡½æ•°ï¼Œæ¯”å¦‚Reluå‡½æ•°ï¼Œå…¶å®ä¸¤ä¸ªReluå‡½æ•°ä¾¿å¯ä»¥é€¼è¿‘sigmoidå‡½æ•°ã€‚

â€‹	è¿™é‡Œæœ‰ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜å°±æ˜¯ï¼Œæ—¢ç„¶åªæœ‰ä¸€ä¸ªéšè—å±‚çš„æµ…å±‚ç¥ç»ç½‘ç»œå¯ä»¥æ‹Ÿåˆå‡ºä»»æ„å‡½æ•°ï¼Œä¸ºä»€ä¹ˆç°åœ¨çš„ç¥ç»ç½‘ç»œæ›´åŠ è¿½æ±‚ç§°ä¸ºä¸€ä¸ªå¾ˆé«˜çš„ç˜¦å­ï¼ˆå³è¿½æ±‚æ·±åº¦ï¼‰ï¼Œå…¶ä¸­çš„ä¸€ä¸ªè§£é‡Šå°±æ˜¯å¦‚æœåªæœ‰ä¸€ä¸ªéšè—å±‚ï¼Œé‚£ä¹ˆå…¶ä¸­çš„å‚æ•°é‡ä¼šéå¸¸å¤šï¼Œå®¹æ˜“å‘ç°è¿‡æ‹Ÿåˆï¼Œå½“ç„¶ç°åœ¨å±‚æ•°å¾ˆå¤šçš„æ·±å±‚ç¥ç»ç½‘ç»œï¼Œçºµç„¶æ˜¯ä½œè€…è‡ªå·±æœ‰äº›åŸå› éƒ½æ— æ³•è§£é‡Šï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç°åœ¨å¾ˆå¤šäººç§°æ·±åº¦å­¦ä¹ ä¸º"ç„å­¦"ï¼Œè¿™é‡Œé¢æ›´å¤šåœ°åŸå› è¿˜éœ€è¦åœ¨ä»¥åçš„å­¦ä¹ ä¸­å»ä½“ä¼šã€‚